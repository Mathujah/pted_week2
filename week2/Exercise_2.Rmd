---
title: "Exercise 2"
author: "Mathujah Manikkan"
date: "5/11/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Task 1: Import your data
Load the necessary libraries
```{r message = FALSE, warning=FALSE}
library(readr)        # to import tabular data (e.g. csv)
library(dplyr)        # to manipulate (tabular) data
library(ggplot2)      # to visualize data
library(sf)           # to handle spatial vector data
library(terra)        # To handle raster data
library(lubridate)    # To handle dates and times
```

Import the downloaded csv
```{r}
wildschwein_BE <- read_delim("wildschwein_BE_2056.csv",",") # adjust path

wildschwein_BE <- st_as_sf(wildschwein_BE, coords = c("E", "N"), crs = 2056, remove = FALSE)

```


## Task 2: Getting an overview
Calculate the time difference between subsequent rows as described in the demo. You can calculate the time difference using the function difftime() in combination with lead().


```{r}

wildschwein_BE$timelag  <- as.integer(difftime(lead(wildschwein_BE$DatetimeUTC), wildschwein_BE$DatetimeUTC, units("secs")))

wildschwein_BE
```
## Now inspect your data in more detail. Try to answer the following questions:

How many individuals were tracked?
```{r}
library(plyr)
count(wildschwein_BE, "TierName")
```
Rosa, Ruth and Sabi, 3 individuals have been tracked. 


For how long were the individual tracked? Are there gaps?
```{r}
summary(wildschwein_BE$DatetimeUTC)
summary(wildschwein_BE$timelag)
```
They been tracked from 22.08.2014 until 27.07.2015. Over this time periode there is one gap (NAs = 1). 


Were all individuals tracked concurrently or sequentially?
```{r}
ggplot(wildschwein_BE, aes(DatetimeUTC, TierID)) +
  geom_line()
```
The start of tracking is different for each individual. However, there are sequences in which all three individuals were tracked simultaneously. 


What is the temporal sampling interval between the locations?
```{r}

ggplot(wildschwein_BE, aes(DatetimeUTC, timelag, colour = TierID)) +
  ylim(0, 20000) +
  geom_point() +
  geom_line()

ggplot

```

